<div class="products-container">

  <!-- HEADER (compact) -->
  <div class="d-flex justify-content-between align-items-center mb-2">
    <div>
      <h3 class="panel-heading mb-0">Products</h3>
      <div class="text-muted small">Manage SKUs, inventory and quick actions</div>
    </div>

    <div class="d-flex align-items-center gap-2">
      <button class="btn btn-outline-secondary btn-sm" id="btn-refresh-products" title="Refresh list">
        ‚ü≥
      </button>
      <button class="btn btn-primary btn-sm" id="btn-open-add-product">+ Add Product</button>
    </div>
  </div>

  <!-- FILTERS ROW (compact) -->
  <div class="d-flex gap-2 mb-3 flex-wrap">
    <input type="text" id="product-search" class="form-control form-control-sm" style="width:280px" placeholder="Search name or SKU...">
    <select id="product-category" class="form-select form-select-sm" style="width:200px">
      <option value="">All Categories</option>
    </select>

    <select id="product-sort" class="form-select form-select-sm" style="width:200px">
      <option value="">Sort by</option>
      <option value="price_asc">Price ‚Üë</option>
      <option value="price_desc">Price ‚Üì</option>
      <option value="stock_asc">Stock ‚Üë</option>
      <option value="stock_desc">Stock ‚Üì</option>
    </select>

    <div class="ms-auto d-flex align-items-center gap-2">
      <small class="text-muted">Page</small>
      <div id="products-pager-compact"></div>
    </div>
  </div>

  <div class="row gx-3">

    <!-- LEFT: Product Table (takes majority) -->
    <div class="col-lg-8">

      <!-- Product Table Card (compact rows) -->
      <div class="card mb-3 p-2">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <strong>Product List</strong>
          <small id="product-count" class="text-muted">0 items</small>
        </div>

        <div class="table-responsive">
          <table class="table table-sm table-hover align-middle mb-0" id="products-table">
            <thead class="table-light">
              <tr>
                <th style="width:72px">Image</th>
                <th>Product</th>
                <th style="width:120px">Category</th>
                <th style="width:80px">Stock</th>
                <th style="width:110px">Status</th>
                <th style="width:120px">Days Left</th>
                <th style="width:140px">Notes</th>
                <th style="width:120px">Actions</th>
              </tr>
            </thead>
            <tbody id="products-body">
              <!-- rendered by JS -->
            </tbody>
          </table>
        </div>

        <!-- compact pager (mobile friendly) -->
        <div id="products-pager" class="p-2 d-flex justify-content-between align-items-center"></div>
      </div>

      <!-- Stock Logs (compact, recent) -->
      <div class="card p-2">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <strong>Recent Stock Activity</strong>
          <small class="text-muted">latest 50</small>
        </div>

        <div class="table-responsive">
          <table class="table table-sm table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>Action</th>
                <th style="width:48px">Img</th>
                <th>Product</th>
                <th style="width:60px">Qty</th>
                <th style="width:60px">Prev</th>
                <th style="width:60px">New</th>
                <th>Reason</th>
                <th style="width:140px">Date</th>
              </tr>
            </thead>
            <tbody id="stocklogs-body">
              <!-- rendered by JS -->
            </tbody>
          </table>
        </div>
      </div>

    </div>

    <!-- RIGHT: Inventory Overview (compact report) -->
    <div class="col-lg-4">

      <div class="card p-3 mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <strong>INVENTORY OVERVIEW</strong>
          <small class="text-muted">Snapshot</small>
        </div>

        <div class="border rounded px-3 py-2 bg-white">
          <div class="d-flex justify-content-between mb-1">
            <div>Total SKUs</div>
            <div class="fw-bold" id="inv-total-skus">0</div>
          </div>

          <div class="d-flex justify-content-between mb-1">
            <div>Low Stock</div>
            <div class="fw-bold text-danger" id="inv-low">0</div>
          </div>

          <div class="d-flex justify-content-between mb-1">
            <div>Out of Stock</div>
            <div class="fw-bold text-danger" id="inv-out">0</div>
          </div>

          <hr class="my-2">

          <div class="d-flex justify-content-between mb-1">
            <div>Fast-Moving</div>
            <div class="fw-bold text-primary" id="inv-fast">0</div>
          </div>

          <div class="d-flex justify-content-between mb-1">
            <div>Slow-Moving</div>
            <div class="fw-bold text-muted" id="inv-slow">0</div>
          </div>
        </div>

        <div class="mt-3 text-muted small">
          <strong>Status Rules</strong>
          <ul class="list-unstyled ms-1 mt-2 status-rules-list">
            <li>‚ùå <strong>OUT</strong> ‚Äî stock = 0</li>
            <li>üî¥ <strong>Low</strong> ‚Äî stock ‚â§ 5</li>
            <li>üü° <strong>Medium</strong> ‚Äî 6‚Äì20</li>
            <li>üü¢ <strong>Good</strong> ‚Äî &gt; 20</li>
          </ul>
        </div>

      </div>

      <!-- Quick actions -->
      <div class="card p-2">
        <div class="d-flex flex-column gap-2">
          <button class="btn btn-outline-primary btn-sm" id="btn-export-csv">Export CSV</button>
          <button class="btn btn-outline-secondary btn-sm" id="btn-import-csv">Import CSV</button>
        </div>
      </div>

    </div>

  </div>

</div>

<!-- MODALS -->
<%- include('../modals/addProduct'); %>
<%- include('../modals/editProduct'); %>
<%- include('../modals/deleteConfirm'); %>
